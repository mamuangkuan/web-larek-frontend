# Проектная работа "Веб-ларек"

Проект представляет собой небольшой шуточный интернет-магазин с товарами для программистов.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура приложения

Приложение построено по архитектурной модели MVP (Model-View-Presenter). Эта модель разделяет логику приложения на три компонента:

- **Model (Модель)**: управляет данными и бизнес-логикой приложения. Она отвечает за получение данных, их хранение и манипуляции с ними.
- **View (Представление)**: отвечает за отображение данных и взаимодействие с пользователем. View получает данные от Presenter и отображает их пользователю.
- **Presenter (Презентер)**: связывает Model и View. Он получает данные из Model, обрабатывает пользовательские действия, поступающие из View, и обновляет View в соответствии с изменениями данных.

Такое разделение позволяет сделать код более структурированным, легко поддерживаемым и тестируемым.

### Базовые классы

#### EventEmitter
Механизм для управления событиями (брокер событий), который позволяет отправлять и подписываться на события.
- **Свойства**:
  - нет

- **Методы**:
  - **on**: подписка на событие
  - **emit**: инициирует событие
  - **trigger**: возвращает функцию для инициализации события

#### Model
Абстрактный класс для слоя данных. Его функции включают получение данных и событий для уведомления об изменениях данных.
- **Конструктор**:
  - принимает данные для инициализации модели и объект событий

- **Свойства**:
  - **events**: объект событий, используемый для уведомления об изменениях модели

- **Методы**:
  - **emitChanges**: сообщает всем, что модель поменялась, инициируя событие


#### Api
Класс для взаимодействия с сервером.
- **Свойства**:
  - нет

- **Методы**:
  - **get**: выполняет GET запрос на указанный эндпоинт и возвращает промис с ответом от сервера.
  - **post**: отправляет данные в теле запроса на указанный эндпоинт с помощью POST запроса. Метод запроса можно изменить, передав третий параметр.

#### Component
Базовый класс для работы с элементами DOM.
- **Конструктор**:
  - принимает контейнер для компонента

- **Свойства**:
  - нет

- **Методы**:
  - **toggleClass**: переключает класс у элемента.
  - **setText**: устанавливает текстовое содержимое элемента.
  - **setDisabled**: устанавливает состояние блокировки элемента.
  - **setHidden**: скрывает элемент.
  - **setVisible**: показывает элемент.
  - **setImage**: устанавливает изображение и альтернативный текст.
  - **render**: возвращает корневой DOM-элемент.

### Слой данных (Model)

#### AppData
Класс для управления состоянием данных приложения. Наследуется от `Model`.
- **Конструктор**:
  - принимает объект событий и передает его в базовый класс вместе с пустым объектом состояния

- **Свойства**:
  - **productsList**: массив товаров
  - **basket**: массив товаров в корзине
  - **formErrors**: ошибки валидации форм
  - **productPreview**: ID карточки для превью
  - **order**: данные заказа

- **Методы**:
  - **Корзина**:
    - **isBasketEmpty**: проверяет, пуста ли корзина.
    - **addProductToBasket**: добавляет товар в корзину.
    - **removeProductFromBasket**: удаляет товар из корзины.
    - **clearBasket**: очищает корзину.
    - **getBasketProducts**: возвращает товары в корзине.
    - **getBasketProductIndex**: возвращает индекс товара в корзине.
    - **calculateTotalPrice**: вычисляет общую стоимость товаров в корзине.
    - **setProductPreview**: устанавливает ID выбранной карточки для превью.
    - **getOrder**: создает объект заказа.
    - **setPaymentMethod**: устанавливает способ оплаты.
    - **setDeliveryAddress**: устанавливает адрес доставки.
    - **setOrderField**: устанавливает значение для полей заказа address, phone и email.
    - **validateOrder**: проверяет заполнение полей заказа.

#### WebLarekApi
Класс для взаимодействия с сервером. Наследуется от `Api`.
- **Свойства**:
  - нет

- **Методы**:
  - **getProductsList**: получает список товаров с сервера.
  - **makeOrder**: отправляет заказ на сервер.

### Слой представления (View)

#### Page
Класс для управления состоянием страницы и отображения товаров. Наследуется от `Component`.
- **Конструктор**:
  - принимает контейнер для карточек товаров и объект событий

- **Свойства**:
  - **_wrapperContainer**: контейнер для модального окна
  - **_basketElement**: элемент корзины
  - **_basketCounter**: элемент счетчика корзины
  - **_productsContainer**: контейнер для товаров

- **Методы**:
  - **set productsContainer**: добавляет товары на страницу.
  - **set basketCounter**: устанавливает количество товаров в корзине.
  - **set scrollLock**: блокирует прокрутку.

#### Card
Класс для отображения данных в карточке товара. Наследуется от `Component`.
- **Конструктор**:
  - принимает HTML-элемент контейнера и необязательный объект с операцией, привязывая метод Click к кнопке действия или контейнеру, если он передан.

- **Свойства**:
  - **_category**: категория товара
  - **_title**: название товара
  - **_description**: описание товара 
  - **_image**: изображение товара
  - **_price**: цена товара 
  - **_actionButton**: кнопка 

- **Методы**:
  - **set title**: устанавливает название.
  - **set description**: устанавливает описание.
  - **set category**: устанавливает категорию.
  - **set price**: устанавливает цену.
  - **set image**: устанавливает изображение.
  - **set actionButtonText**: устанавливает текст на кнопке.

#### Basket
Класс для отображения корзины. Наследуется от `Component`.
- **Конструктор**:
  - принимает контейнер для данных корзины и объект событий

- **Свойства**:
  - **basketProductsList**: список товаров в корзине
  - **totalPrice**: элемент с общей стоимостью 
  - **basketButton**: кнопка корзины

- **Методы**:
  - **set products**: устанавливает список товаров.
  - **set price**: устанавливает общую стоимость товаров.

#### Form
Класс для работы с формами. Наследуется от `Component`.
- **Свойства**:
  - **submitButton**: кнопка отправки формы
  - **formErrors**: элемент для отображения ошибок

- **Методы**:
  - **set validity**: устанавливает валидность формы.
  - **set errors**: устанавливает ошибки формы.
  - **render**: отрисовывает форму.
  - **inputChange**: проверяет поле.

#### OrderForm
Класс для формы заказа. Наследуется от `Form`.
- **Свойства**:
  - **onlinePaymentButton**: кнопка выбора онлайн оплаты
  - **cashPaymentButton**: кнопка выбора оплаты при получении
  - **payment**: способ оплаты

- **Методы**:
  - **set address**: устанавливает адрес доставки.
  - **addPaymentMethod**: добавляет способ оплаты.
  - **removePaymentMethod**: удаляет способ оплаты.

#### ContactForm
Класс для формы контактных данных. Наследуется от `Form`.
- **Конструктор**:
  - принимает контейнер для данных контактов и объект событий

- **Методы**:
  - **set email**: устанавливает email.
  - **set phone**: устанавливает телефон.

#### SuccessForm
Класс для отображения сообщения об успешном заказе. Наследуется от `Component`.
- **Конструктор**:
  - принимает контейнер данных об успешном заказе и объект событий

- **Свойства**:
  - **closeButton**: кнопка закрытия
  - **totalSpent**: общее количество потраченных средств

- **Методы**:
  - **set TotalSpentCounter**: устанавливает количество потраченных средств.

#### Modal
Класс для работы с модальными окнами. Наследуется от `Component`.
- **Конструктор**:
  - принимает контейнер для данных модального окна и объект событий

- **Свойства**:
  - **button**: кнопка модального окна
  - **content**: содержимое модального окна

- **Методы**:
  - **set content**: устанавливает содержимое.
  - **render**: отрисовывает модальное окно.
  - **open**: открывает модальное окно.
  - **close**: закрывает модальное окно.

### Презентер (Presenter)

#### index.ts
Презентер связывает View и Model, обрабатывает события от View и обновляет данные в Model. Он обеспечивает логику работы приложения и взаимодействие между слоями.


### Интерфейсы

#### IProduct

Интерфейс товара.

```typescript
export interface IProduct extends ICard {
	title: string;
	id: string;
	category: string;
	description: string;
	image: string;
	price: number | null;	
}
```

#### ICard

Интерфейс карточки товара.

```typescript
export interface ICard {
	actionButtonText: string;	
}
```

#### IAppData

Интерфейс данных приложения.

```typescript
interface IAppData {
    products: IProduct[];
    basket: IProduct[];
}
```

#### IForm

Интерфейс окна формы.

```typescript
interface IForm {
    errors: string[];
    valid: boolean;
}
```

#### IOrderForm

Интерфейс модального окна заказа.

```typescript
interface IOrderForm {
    payment: string;
    address: string;
}
```

#### IContactForm

Интерфейс заполнения контактной информации.

```typescript
interface IContactForm {
    email: string;
    phone: string;
}
```

#### IOrder

Интерфейс заказа.

```typescript
interface IOrder {
		payment: string,
		address: string,
		phone: string,
		email: string,
}
```

#### FormErrors

Интерфейс валидации формы.

```typescript
type FormErrors = Partial<Record<keyof IOrder, string>>;
```

#### IBasket

Интерфейс корзины.

```typescript
interface IBasket {
    products: HTMLElement[];
    price: number;
}
```

#### ISuccessForm

Интерфейс успешного оформления заказа.

```typescript
interface ISuccessForm {
    count: number | string;
}
```

#### IOperation

Интерфейс действий над карточкой.

```typescript
interface IOperation {
    Click: (event: MouseEvent) => void;
}
```

#### ISuccessResult

Интерфейс действий окна успешного оформления заказа.

```typescript
interface ISuccessResult {
    Click: () => void;
}
```

#### IPage

Интерфейс главной страницы.

```typescript
interface IPage {
	  productsContainer: HTMLElement[];
	  basketCounter: number;
	  scrollLock: boolean;
}
```

#### IOrderResult

Интерфейс данных ответа сервера на создание заказа.

```typescript
interface IOrderResult {
    id: string;
    total: number;
}
```

#### IModal

Интерфейс модального окна.

```typescript
interface IModal {
    content: HTMLElement;
}
```